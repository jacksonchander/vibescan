// share-image-generator.js
// Creates an exportable image of the user's score and persona
function generateShareImage(options = {}){
  const score = localStorage.getItem('vibeScanMainScore') || 'N/A';
  const persona = localStorage.getItem('vibeScanPersonalityType') || 'The Influencer';
  const name = options.name || localStorage.getItem('vibeScanName') || 'You';
  const aura = options.aura || localStorage.getItem('vibeScanAura') || '#00d4ff';

  const canvas = document.createElement('canvas');
  canvas.width = 1200; canvas.height = 1200;
  const ctx = canvas.getContext('2d');

  // background
  const g = ctx.createLinearGradient(0,0,1200,1200);
  g.addColorStop(0, aura);
  g.addColorStop(1, '#0b0f2b');
  ctx.fillStyle = g; ctx.fillRect(0,0,1200,1200);

  // score circle
  ctx.beginPath(); ctx.fillStyle = 'rgba(255,255,255,0.06)'; ctx.arc(600,480,260,0,Math.PI*2); ctx.fill();
  ctx.fillStyle = '#fff'; ctx.font = 'bold 180px Arial'; ctx.textAlign='center'; ctx.fillText(score,600,530);

  ctx.font='28px Arial'; ctx.fillStyle='rgba(255,255,255,0.9)'; ctx.fillText(persona,600,650);
  ctx.font='22px Arial'; ctx.fillStyle='rgba(255,255,255,0.7)'; ctx.fillText('Generated by VibeScan',600,720);

  // badges placeholder
  ctx.font='18px Arial'; ctx.fillStyle='rgba(255,255,255,0.8)'; ctx.fillText('Badges: ' + (localStorage.getItem('vibeScanBadges')||'None'),600,780);

  // return blob
  return new Promise(resolve=>{
    canvas.toBlob(blob => resolve(blob), 'image/png');
  });
}

window.generateShareImage = generateShareImage;
